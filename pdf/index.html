<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PDF Konvertor</title>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const inputs = ["images", "word", "ppt"];
      const form = document.getElementById("uploadForm");

      inputs.forEach((id) => {
        document.getElementById(id).addEventListener("change", () => {
          // Boshqa inputlarni tozalash (DOM orqali)
          inputs.forEach((otherId) => {
            if (otherId !== id) {
              const input = document.getElementById(otherId);
              const newInput = input.cloneNode(); // yangi input yaratamiz
              newInput.id = otherId;
              newInput.name = otherId;
              newInput.className = input.className;
              newInput.accept = input.accept;
              input.parentNode.replaceChild(newInput, input);
            }
          });

          // Yuklab olish linkini yashirish
          const downloadLink = document.getElementById("downloadLink");
          downloadLink.classList.add("hidden");
          const link = document.getElementById("fileLink");
          link.href = "#";
          link.textContent = "";
        });
      });

      form.addEventListener("submit", async function (e) {
        e.preventDefault();
        const formData = new FormData();

        const imagesInput = document.getElementById("images");
        const wordInput = document.getElementById("word");
        const pptInput = document.getElementById("ppt");

        if (imagesInput.files.length > 0) {
          for (const file of imagesInput.files) {
            formData.append("images", file);
          }
        } else if (wordInput.files.length > 0) {
          formData.append("word", wordInput.files[0]);
        } else if (pptInput.files.length > 0) {
          formData.append("ppt", pptInput.files[0]);
        } else {
          alert("Iltimos, fayl tanlang!");
          return;
        }

        try {
          const res = await fetch("https://oefenplus-backend-pdf-1.onrender.com/convert", {
            method: "POST",
            body: formData
          });

          if (!res.ok) throw new Error("Serverdan xatolik!");

          const blob = await res.blob();
          const url = URL.createObjectURL(blob);
          const link = document.getElementById("fileLink");
          link.href = url;
          link.download = "converted.pdf";
          link.textContent = "PDFni yuklab olish";
          document.getElementById("downloadLink").classList.remove("hidden");
        } catch (err) {
          alert("Xatolik yuz berdi: " + err.message);
        }
      });
    });
  </script>
  <style>
    body { font-family: sans-serif; padding: 2rem; background-color: #f9f9f9; }
    input { margin: 10px 0; }
    .hidden { display: none; }
    #downloadLink a { color: blue; text-decoration: underline; }
  </style>
</head>
<body>
  <h2>PDF Konvertor</h2>
  <form id="uploadForm">
    <label>Rasmlar (JPG, PNG):</label><br>
    <input type="file" id="images" name="images" accept="image/*" multiple /><br><br>

    <label>Word fayl (.docx):</label><br>
    <input type="file" id="word" name="word" accept=".docx" /><br><br>

    <label>PowerPoint fayl (.pptx):</label><br>
    <input type="file" id="ppt" name="ppt" accept=".pptx" /><br><br>

    <button type="submit">PDFga aylantirish</button>
  </form>

  <div id="downloadLink" class="hidden">
    <p><a id="fileLink" href="#" download>PDFni yuklab olish</a></p>
  </div>
</body>
</html>
